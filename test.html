<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GateForge - í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a1a;
            color: #0f0;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #0f0;
            background: #000;
        }
        .pass { color: #0f0; }
        .fail { color: #f00; }
        .warn { color: #ff0; }
        pre {
            background: #111;
            padding: 10px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ”Œ GateForge - ì½”ë“œ ê²€ì¦ í…ŒìŠ¤íŠ¸</h1>
    
    <div class="test-section">
        <h2>ğŸ“¦ ëª¨ë“ˆ ë¡œë“œ í…ŒìŠ¤íŠ¸</h2>
        <div id="module-test"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ—ï¸ í´ë˜ìŠ¤ ì •ì˜ í…ŒìŠ¤íŠ¸</h2>
        <div id="class-test"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ”— ì „ì—­ ë³€ìˆ˜ í…ŒìŠ¤íŠ¸</h2>
        <div id="global-test"></div>
    </div>

    <div class="test-section">
        <h2>âš™ï¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h2>
        <div id="function-test"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ¨ DOM í…ŒìŠ¤íŠ¸</h2>
        <div id="dom-test"></div>
    </div>

    <!-- ì‹¤ì œ ì•± íŒŒì¼ë“¤ ë¡œë“œ -->
    <script src="js/Gate.js"></script>
    <script src="js/Connection.js"></script>
    <script src="js/presets.js"></script>
    <script>
        // script.js ëŒ€ì‹  í…ŒìŠ¤íŠ¸ìš© ì „ì—­ ë³€ìˆ˜ë§Œ ì •ì˜
        let gates = [];
        let connections = [];
        let animationTime = 0;
    </script>
    <script src="js/presets.js"></script>

    <!-- í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        function log(elementId, message, status = 'pass') {
            const el = document.getElementById(elementId);
            const className = status === 'pass' ? 'pass' : status === 'fail' ? 'fail' : 'warn';
            el.innerHTML += `<div class="${className}">${status === 'pass' ? 'âœ“' : status === 'fail' ? 'âœ—' : 'âš '} ${message}</div>`;
        }

        // ëª¨ë“ˆ ë¡œë“œ í…ŒìŠ¤íŠ¸
        try {
            if (typeof Gate === 'function') {
                log('module-test', 'Gate.js ë¡œë“œ ì„±ê³µ');
            } else {
                log('module-test', 'Gate.js ë¡œë“œ ì‹¤íŒ¨', 'fail');
            }

            if (typeof Connection === 'function') {
                log('module-test', 'Connection.js ë¡œë“œ ì„±ê³µ');
            } else {
                log('module-test', 'Connection.js ë¡œë“œ ì‹¤íŒ¨', 'fail');
            }

            if (typeof createPreset === 'function') {
                log('module-test', 'presets.js ë¡œë“œ ì„±ê³µ');
            } else {
                log('module-test', 'presets.js ë¡œë“œ ì‹¤íŒ¨', 'fail');
            }
        } catch (e) {
            log('module-test', `ëª¨ë“ˆ ë¡œë“œ ì˜¤ë¥˜: ${e.message}`, 'fail');
        }

        // í´ë˜ìŠ¤ ì •ì˜ í…ŒìŠ¤íŠ¸
        try {
            const testGate = new Gate('INPUT', 100, 100);
            if (testGate.type === 'INPUT' && testGate.x === 100 && testGate.y === 100) {
                log('class-test', 'Gate í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ');
            } else {
                log('class-test', 'Gate í´ë˜ìŠ¤ ì†ì„± ì˜¤ë¥˜', 'fail');
            }

            if (typeof testGate.compute === 'function') {
                const result = testGate.compute();
                log('class-test', `Gate.compute() ì‹¤í–‰ ì„±ê³µ (ê²°ê³¼: ${result})`);
            } else {
                log('class-test', 'Gate.compute() ë©”ì„œë“œ ì—†ìŒ', 'fail');
            }

            const testGate2 = new Gate('OUTPUT', 200, 100);
            const testConn = new Connection(testGate, testGate2, 0);
            if (testConn.from === testGate && testConn.to === testGate2) {
                log('class-test', 'Connection í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ');
            } else {
                log('class-test', 'Connection í´ë˜ìŠ¤ ì†ì„± ì˜¤ë¥˜', 'fail');
            }
        } catch (e) {
            log('class-test', `í´ë˜ìŠ¤ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${e.message}`, 'fail');
        }

        // ì „ì—­ ë³€ìˆ˜ í…ŒìŠ¤íŠ¸
        try {
            if (Array.isArray(gates)) {
                log('global-test', 'gates ë°°ì—´ ì •ì˜ë¨');
            } else {
                log('global-test', 'gates ë°°ì—´ ì—†ìŒ', 'fail');
            }

            if (Array.isArray(connections)) {
                log('global-test', 'connections ë°°ì—´ ì •ì˜ë¨');
            } else {
                log('global-test', 'connections ë°°ì—´ ì—†ìŒ', 'fail');
            }

            if (typeof animationTime === 'number') {
                log('global-test', `animationTime ë³€ìˆ˜ ì •ì˜ë¨ (ê°’: ${animationTime})`);
            } else {
                log('global-test', 'animationTime ë³€ìˆ˜ ì—†ìŒ', 'fail');
            }
        } catch (e) {
            log('global-test', `ì „ì—­ ë³€ìˆ˜ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${e.message}`, 'fail');
        }

        // ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
        try {
            // AND ê²Œì´íŠ¸ í…ŒìŠ¤íŠ¸
            const andGate = new Gate('AND', 100, 100);
            const input1 = new Gate('INPUT', 0, 80);
            const input2 = new Gate('INPUT', 0, 120);
            
            input1.value = 1;
            input2.value = 1;
            
            const conn1 = new Connection(input1, andGate, 0);
            const conn2 = new Connection(input2, andGate, 1);
            
            andGate.inputs = [conn1, conn2];
            
            const result = andGate.compute();
            if (result === 1) {
                log('function-test', 'AND ê²Œì´íŠ¸ (1,1) â†’ 1 ê³„ì‚° ì„±ê³µ');
            } else {
                log('function-test', `AND ê²Œì´íŠ¸ ê³„ì‚° ì˜¤ë¥˜ (ì˜ˆìƒ: 1, ê²°ê³¼: ${result})`, 'fail');
            }

            input2.value = 0;
            const result2 = andGate.compute();
            if (result2 === 0) {
                log('function-test', 'AND ê²Œì´íŠ¸ (1,0) â†’ 0 ê³„ì‚° ì„±ê³µ');
            } else {
                log('function-test', `AND ê²Œì´íŠ¸ ê³„ì‚° ì˜¤ë¥˜ (ì˜ˆìƒ: 0, ê²°ê³¼: ${result2})`, 'fail');
            }

            // XOR ê²Œì´íŠ¸ í…ŒìŠ¤íŠ¸
            const xorGate = new Gate('XOR', 100, 100);
            xorGate.inputs = [conn1, conn2];
            input1.value = 1;
            input2.value = 1;
            const xorResult = xorGate.compute();
            if (xorResult === 0) {
                log('function-test', 'XOR ê²Œì´íŠ¸ (1,1) â†’ 0 ê³„ì‚° ì„±ê³µ');
            } else {
                log('function-test', `XOR ê²Œì´íŠ¸ ê³„ì‚° ì˜¤ë¥˜ (ì˜ˆìƒ: 0, ê²°ê³¼: ${xorResult})`, 'fail');
            }

            // í”„ë¦¬ì…‹ í•¨ìˆ˜ ì¡´ì¬ í™•ì¸
            const presetFunctions = [
                'createHalfAdder',
                'createFullAdder',
                'createSRLatch',
                'createMultiplexer',
                'createDecoder',
                'createXORNeuralNet',
                'createPatternMatcher',
                'createSimpleClassifier'
            ];

            presetFunctions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    log('function-test', `${funcName} í•¨ìˆ˜ ì •ì˜ë¨`);
                } else {
                    log('function-test', `${funcName} í•¨ìˆ˜ ì—†ìŒ`, 'fail');
                }
            });

        } catch (e) {
            log('function-test', `ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${e.message}`, 'fail');
        }

        // DOM í…ŒìŠ¤íŠ¸ (ì‹¤ì œ ì•± HTMLì´ ì•„ë‹ˆë¯€ë¡œ ê²½ê³ )
        log('dom-test', 'canvas ìš”ì†ŒëŠ” index.htmlì—ì„œ í…ŒìŠ¤íŠ¸ í•„ìš”', 'warn');
        log('dom-test', '.gate-btn ìš”ì†ŒëŠ” index.htmlì—ì„œ í…ŒìŠ¤íŠ¸ í•„ìš”', 'warn');
        log('dom-test', 'ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ” ì‹¤ì œ ì•±ì—ì„œ ìë™ ì‹¤í–‰ë¨', 'warn');

        // ìµœì¢… ê²°ê³¼
        setTimeout(() => {
            const allTests = document.querySelectorAll('.fail');
            if (allTests.length === 0) {
                document.body.innerHTML += '<h2 style="color: #0f0; text-align: center;">âœ“ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼!</h2>';
            } else {
                document.body.innerHTML += `<h2 style="color: #f00; text-align: center;">âœ— ${allTests.length}ê°œ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨</h2>`;
            }
        }, 100);
    </script>
</body>
</html>
